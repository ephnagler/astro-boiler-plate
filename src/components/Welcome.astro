---
import type { SanityDocument } from "@sanity/client";
import { loadQuery } from "./../sanity/lib/load-query";

// Fetch settings data with referenced theme (singleton document)
const { data: siteSettings } = await loadQuery<SanityDocument>({
  query: `*[_id == "siteSettings"][0]{
    title,
    liveTheme->{
      _id,
      title,
      defaultColorScheme->{
        _id,
        colorScheme,
        backgroundColor,
        textColor,
        accentColor
      }
    }
  }`,
});
---

<script define:vars={{ siteSettings }}>
  console.log("Settings data (client-side):", siteSettings);
</script>

<div>
  <main>
    <section>
      <h1>{siteSettings?.title || "Welcome"}</h1>
      {
        siteSettings?.liveTheme && (
          <div>
            <h2>Current Theme: {siteSettings.liveTheme.title}</h2>
            <p>Theme ID: {siteSettings.liveTheme._id}</p>
          </div>
        )
      }
    </section>
  </main>
</div>
